<!DOCTYPE html>
<html>
    <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="google-site-verification" content="0FNbiBWk1FugWYo-RiGxQyIHebGeLoXp3HB7AxIFKy8" />
    <meta name="baidu-site-verification" content="tYoUqpkCCv" />
    <meta name="baidu-site-verification" content="IGN97NW90O" />
    
    <title>webpack--更优秀的打包管理工具 | ouvenzhang的博客</title>

    <meta http-equiv="x-dns-prefetch-control" content="on" />
    <link rel="dns-prefetch" href="cdnjs.cloudflare.com" />
    <link rel="dns-prefetch" href="1.url.cn" />

    <meta name="description" itemprop="description" content="webpack--更优秀的打包管理工具,webpack,打包工具 ">
    <meta itemprop="name" content="webpack--更优秀的打包管理工具">
    <meta itemprop="image" content="http://ouvens.github.io/blog/assets/logo.png">
    <meta itemprop="keywords" name="keywords" content="webpack--更优秀的打包管理工具,webpack,打包工具 ">

    
    <meta name="author" content="ouvenzhang">
    <meta name="copyright" content="&copy; ouvenzhang 2017">
    <meta name="protocol" content="1">
    

    <!-- External libraries -->
    <link rel="stylesheet" href="/assets/css/iconfont.css">
    <link rel="stylesheet" href="/css/monokai_sublime.css">

    <!-- Favicon and other icons (made with http://www.favicon-generator.org/) -->
    <link rel="shortcut icon" href="/assets/favicon.ico" type="image/x-icon">
  	<link rel="icon" href="/assets/favicon.ico" type="image/x-icon">
    
  	<meta name="msapplication-TileColor" content="#ffffff">
  	<meta name="theme-color" content="#ffffff">
    <meta name="msapplication-TileImage" content="/assets/icons/icon.png">

  	<!-- Site styles -->
    <link rel="stylesheet" href="/css/main.css">

    <link rel="alternate" type="application/rss+xml" title="极限前端" href="http://ouvens.github.io//feed.xml" />
    <script>
    // 访问统计
    var domain = 'jixianqianduan.com';
    var oldDomain = 'ouvens.github.io';
    if(location.host === domain){
        var _hmt = _hmt || [];
        (function() {
          var hm = document.createElement("script");
          hm.src = "//hm.baidu.com/hm.js?b536b128dc21c3d18fdc028f0609e3f0";
          var s = document.getElementsByTagName("script")[0]; 
          s.parentNode.insertBefore(hm, s);
        })();
    }else if(location.host === oldDomain){
        window.location.href = location.href.replace(oldDomain, domain);
        var _hmt = _hmt || [];
        (function() {
          var hm = document.createElement("script");
          hm.src = "//hm.baidu.com/hm.js?041efd2cb345ca1b9dbdbb2383cb716d";
          var s = document.getElementsByTagName("script")[0]; 
          s.parentNode.insertBefore(hm, s);
        })();
    }

    // 链接提交

    if(location.protocol === 'https'){
        !function(){var e=/([http|https]:\/\/[a-zA-Z0-9\_\.]+\.baidu\.com)/gi,r=window.location.href,t=document.referrer;if(!e.test(r)){var o="https://sp0.baidu.com/9_Q4simg2RQJ8t7jm9iCKT-xh_/s.gif";t?(o+="?r="+encodeURIComponent(document.referrer),r&&(o+="&l="+r)):r&&(o+="?l="+r);var i=new Image;i.src=o}}(window);
    }else{
        !function(){var e=/([http|https]:\/\/[a-zA-Z0-9\_\.]+\.baidu\.com)/gi,r=window.location.href,o=document.referrer;if(!e.test(r)){var n="//api.share.baidu.com/s.gif";o?(n+="?r="+encodeURIComponent(document.referrer),r&&(n+="&l="+r)):r&&(n+="?l="+r);var t=new Image;t.src=n}}(window);
    }


    </script>
</head>

    <body>
        <div class="navigation" role="banner">
    <div class="navigation-wrapper">
    <a href="/" class="logo">
    	
      <img src="/assets/logo.png" alt="极限前端">
      
    </a>
    <span class="search-input" id="search-input">
      <input type="text" value="" class="search-text" placeholder="输入搜索关键字">
      <i class="icon-font i-search search-btn"></i>
    </span>
    <a href="javascript:void(0)" class="navigation-menu-button" id="js-mobile-menu">
    	<i class="icon-font i-list fa fa-bars"></i>
    </a>
    <span class="nav" role="navigation">
      <ul id="js-navigation-menu" class="navigation-menu show">
      	
          
          <li class="nav-link">
            <a href="/about/">关于</a>
          </li>
          
        
          
        
          
        
          
        
          
          <li class="nav-link">
            <a href="/category/">所有文章</a>
          </li>
          
        
          
          <li class="nav-link">
            <a href="/tags/">标签分类</a>
          </li>
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          <li id="github-info" class="nav-link" title="https://github.com/ouvens">
            <a class="github-info" href="https://github.com/ouvens" target="_blank">
            <img src="/assets/github.png" height="34" width="130" alt="github地址"></a>
          </li>
      </ul>
    </span>
  </div>
</div>

            <div class="page-content">
        <div class="post">
<div class="post-header-container has-cover">
	<header class="post-header">
	  <h1 class="title">webpack--更优秀的打包管理工具</h1>
	  <p class="info">by <strong>ouven</strong></p>
	</header>
</div>
<div class="wrapper">



<div class="post-meta">
	<div class="post-date">2015年04月01日</div>
	<div class="post-categories">
	 in  
		<a target="_blank" href="/category/?cate=frontend-build">Frontend-build</a>
	  
	</div>
</div>	

<article class="post-content">
  <h2 id="webpack">webpack是什么</h2>
<p>德国开发者Tobias Koppers开发的模块加载器，可用于处理依赖分析和进行打包。</p>

<h2 id="commonjsamd">commonJS与AMD支持</h2>
<p>Webpack 对 CommonJS 的 AMD 的语法做了兼容，不过实际上, 引用模块的规则是依据 CommonJS 来的，即如果使用AMD语法，还是根据commonJS语法进行模块查找的。
当然我们之前可也以这么写来兼容AMD和commonJS，但是用了webpack语法上就可以任意去写了：</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13</pre></td><td class="code"><pre>
<span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nb">window</span><span class="p">,</span> <span class="nx">factory</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">typeod</span> <span class="nx">exports</span> <span class="o">===</span> <span class="s1">'object'</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="nx">factory</span><span class="p">();</span>
    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">define</span> <span class="o">===</span> <span class="s1">'function'</span> <span class="o">&amp;&amp;</span> <span class="nx">define</span><span class="p">.</span><span class="nx">amd</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">define</span><span class="p">([],</span><span class="nx">factory</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nb">window</span><span class="p">.</span><span class="nx">eventUtil</span> <span class="o">=</span> <span class="nx">factory</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">})(</span><span class="k">this</span><span class="p">,</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="c1">//module ...</span>
<span class="p">});</span>

</pre></td></tr></tbody></table>
</div>
</div>

<h2 id="webpack-1">如何命令调用webpack</h2>

<p>切换到含有webpack.config.js的目录，执行以下命令：
webpack        开发调试环境构建
webpack -p    产品发布环境构建，包含压缩，minify最小化
webpack        –watch 开发调试环境并开启文件watch(fast!)
webpack -d    包含source map打包</p>

<h2 id="section">基本配置使用</h2>

<p>安装webpack模块之后, 可是使用 webpack 这个命令行工具进行文件打包等处理，可以使用参数, 也可以配置 webpack.config.js 文件直接运行 webpack 调用。或者使用gulp或grunt的webpack插件，结合其他的插件一起使用。例如使用webpack打包一个文件的配置就可以这么写：</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23</pre></td><td class="code"><pre>
<span class="c1">// webpack.config.js</span>
<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">entry</span><span class="p">:</span> <span class="s1">'./main.js'</span><span class="p">,</span>
  <span class="na">output</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">filename</span><span class="p">:</span> <span class="s1">'bundle.js'</span>       
  <span class="p">}</span>
<span class="p">};</span>
<span class="err">当然也可以这样，</span><span class="nx">webpack</span><span class="err">支持了</span><span class="nx">coffee</span><span class="err">和</span><span class="nx">jsx</span><span class="err">，喜欢玩</span><span class="nx">react</span><span class="err">的同学可以试下。</span>
<span class="c1">// webpack.config.js</span>
<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">entry</span><span class="p">:</span> <span class="s1">'./main.js'</span><span class="p">,</span>
  <span class="na">output</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">filename</span><span class="p">:</span> <span class="s1">'bundle.js'</span>       
  <span class="p">},</span>
  <span class="na">module</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">loaders</span><span class="p">:</span> <span class="p">[</span>
      <span class="p">{</span> <span class="na">test</span><span class="p">:</span> <span class="sr">/</span><span class="se">\.</span><span class="sr">coffee$/</span><span class="p">,</span> <span class="na">loader</span><span class="p">:</span> <span class="s1">'coffee-loader'</span> <span class="p">},</span>
      <span class="p">{</span> <span class="na">test</span><span class="p">:</span> <span class="sr">/</span><span class="se">\.</span><span class="sr">js$/</span><span class="p">,</span> <span class="na">loader</span><span class="p">:</span> <span class="s1">'jsx-loader?harmony'</span> <span class="p">}</span> <span class="c1">// loaders can take parameters as a querystring</span>
    <span class="p">]</span>
  <span class="p">}</span>
<span class="p">};</span>

</pre></td></tr></tbody></table>
</div>
</div>

<h2 id="section-1">文件查找依赖</h2>

<p>Webpack 是在本地按目录对依赖进行查找的，构造一个例子，可以用 –display-error-details 查看查找过程，例如一下例子配置当中 resolve.extensions 用于指明程序自动补全识别哪些后缀，需要注意的是， extensions 一般需要包含空字符串的情况，对应不需要后缀的情况。</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12</pre></td><td class="code"><pre>
<span class="c1">// webpack.config.js</span>
<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">entry</span><span class="p">:</span> <span class="s1">'./a.js'</span><span class="p">,</span>
  <span class="na">output</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">filename</span><span class="p">:</span> <span class="s1">'b.js'</span>
  <span class="p">},</span>
  <span class="na">resolve</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">extensions</span><span class="p">:</span> <span class="p">[</span><span class="s1">''</span><span class="p">,</span> <span class="s1">'.coffee'</span><span class="p">,</span> <span class="s1">'.js'</span><span class="p">,</span> <span class="s1">'.coffee'</span><span class="p">]</span>
  <span class="p">}</span>
<span class="p">}</span>

</pre></td></tr></tbody></table>
</div>
</div>

<h2 id="css">图片及css的引用</h2>

<p>css跟 less，还有图片，被直接引用了。实际上 CSS 被转化为style标签，而图片可能被转化成 base64 格式的dataUrl，但是要主要在 webpack.config.js 文件写好对应的 loader：</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22</pre></td><td class="code"><pre><span class="nx">require</span><span class="p">(</span><span class="s1">'./bootstrap.css'</span><span class="p">);</span>
<span class="nx">require</span><span class="p">(</span><span class="s1">'./myapp.less'</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">img</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">'img'</span><span class="p">);</span>
<span class="nx">img</span><span class="p">.</span><span class="nx">src</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'./glyph.png'</span><span class="p">);</span>

<span class="c1">// webpack.config.js</span>
<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">entry</span><span class="p">:</span> <span class="s1">'./main.js'</span><span class="p">,</span>
  <span class="na">output</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">path</span><span class="p">:</span> <span class="s1">'./build'</span><span class="p">,</span> <span class="c1">// This is where images AND js will go</span>
    <span class="na">publicPath</span><span class="p">:</span> <span class="s1">'http://mycdn.com/'</span><span class="p">,</span> <span class="c1">// This is used to generate URLs to e.g. images</span>
    <span class="na">filename</span><span class="p">:</span> <span class="s1">'bundle.js'</span>
  <span class="p">},</span>
  <span class="na">module</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">loaders</span><span class="p">:</span> <span class="p">[</span>
      <span class="p">{</span> <span class="na">test</span><span class="p">:</span> <span class="sr">/</span><span class="se">\.</span><span class="sr">less$/</span><span class="p">,</span> <span class="na">loader</span><span class="p">:</span> <span class="s1">'style-loader!css-loader!less-loader'</span> <span class="p">},</span> <span class="c1">// use ! to chain loaders</span>
      <span class="p">{</span> <span class="na">test</span><span class="p">:</span> <span class="sr">/</span><span class="se">\.</span><span class="sr">css$/</span><span class="p">,</span> <span class="na">loader</span><span class="p">:</span> <span class="s1">'style-loader!css-loader'</span> <span class="p">},</span>
      <span class="p">{</span><span class="na">test</span><span class="p">:</span> <span class="sr">/</span><span class="se">\.(</span><span class="sr">png|jpg</span><span class="se">)</span><span class="sr">$/</span><span class="p">,</span> <span class="na">loader</span><span class="p">:</span> <span class="s1">'url-loader?limit=8192'</span><span class="p">}</span> <span class="c1">// inline base64 URLs for &lt;=8k images, direct URLs for the rest</span>
    <span class="p">]</span>
  <span class="p">}</span>
<span class="p">};</span>

</pre></td></tr></tbody></table>
</div>
</div>

<p>这样我们就可以做很多事情了，尤其是移动端，为了避免过多的css和图片请求，可以通过及其简单的配置就可以在打包时系统帮我们自动做到inline css和图片。</p>

<h2 id="url-loader">url-loader是什么</h2>

<p>url-loader是对文件加载器file-loader的封装，并且在file-loader完成后进行一些更多的处理</p>

<div class="language-css highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4</pre></td><td class="code"><pre><span class="nc">.demo</span> <span class="p">{</span>
  <span class="nl">background-image</span><span class="p">:</span> <span class="sx">url('a.png')</span><span class="p">;</span>
<span class="p">}</span>

</pre></td></tr></tbody></table>
</div>
</div>

<p>例如以上图片的引用，通过配置可以把a.png抓出来，并按照文件大小，转化为base64或作为单独文件</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7</pre></td><td class="code"><pre>
<span class="nl">module</span><span class="p">:</span> <span class="p">{</span>
  <span class="nl">loaders</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span><span class="na">test</span><span class="p">:</span> <span class="sr">/</span><span class="se">\.(</span><span class="sr">png|jpg</span><span class="se">)</span><span class="sr">$/</span><span class="p">,</span> <span class="na">loader</span><span class="p">:</span> <span class="s1">'url-loader?limit=8192'</span><span class="p">}</span> <span class="c1">// inline base64 URLs for &lt;=8k images, direct URLs for the rest</span>
  <span class="p">]</span>
<span class="p">}</span>

</pre></td></tr></tbody></table>
</div>
</div>

<h2 id="section-2">优化打成多个技术文件包</h2>
<p>有时考虑类库代码的缓存，同时也需要打多个文件包，这样也很简单，比如下边的配置,，首先 entry 有多个属性, 对应多个 JavaScript 包，然后 commonsPlugin 可以用于分析模块的共用代码，单独打一个包出来:
https://github.com/petehunt/webpack-howto#8-optimizing-common-code
https://github.com/webpack/docs/wiki/optimization#multi-page-app</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16</pre></td><td class="code"><pre>
<span class="c1">// webpack.config.js</span>
<span class="kd">var</span> <span class="nx">webpack</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'webpack'</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">commonsPlugin</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">webpack</span><span class="p">.</span><span class="nx">optimize</span><span class="p">.</span><span class="nx">CommonsChunkPlugin</span><span class="p">(</span><span class="s1">'common.js'</span><span class="p">);</span>
<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">entry</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">Profile</span><span class="p">:</span> <span class="s1">'./profile.js'</span><span class="p">,</span>
    <span class="na">Feed</span><span class="p">:</span> <span class="s1">'./feed.js'</span>
  <span class="p">},</span>
  <span class="na">output</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">path</span><span class="p">:</span> <span class="s1">'build'</span><span class="p">,</span>
    <span class="na">filename</span><span class="p">:</span> <span class="s1">'[name].js'</span> <span class="c1">// Template based on keys in entry above</span>
  <span class="p">},</span>
  <span class="na">plugins</span><span class="p">:</span> <span class="p">[</span><span class="nx">commonsPlugin</span><span class="p">]</span>
<span class="p">};</span>

</pre></td></tr></tbody></table>
</div>
</div>

<p>如果入口传入的是一个数组，则会把多个文件一起打包，最后导出最后一个</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13</pre></td><td class="code"><pre><span class="p">{</span>
    <span class="nl">entry</span><span class="p">:</span> <span class="p">{</span>
        <span class="nl">page1</span><span class="p">:</span> <span class="s2">"./page1"</span><span class="p">,</span>
        <span class="nx">page2</span><span class="err">:</span> <span class="p">[</span><span class="s2">"./entry1"</span><span class="p">,</span> <span class="s2">"./entry2"</span><span class="p">]</span>
    <span class="p">},</span>
    <span class="nx">output</span><span class="err">:</span> <span class="p">{</span>
        <span class="c1">// Make sure to use [name] or [id] in output.filename</span>
        <span class="c1">//  when using multiple entry points</span>
        <span class="nl">filename</span><span class="p">:</span> <span class="s2">"[name].bundle.js"</span><span class="p">,</span>
        <span class="nx">chunkFilename</span><span class="err">:</span> <span class="s2">"[id].bundle.js"</span>
    <span class="p">}</span>
<span class="p">}</span>

</pre></td></tr></tbody></table>
</div>
</div>

<p>这里profile和feed都引了common.js，但是webpack不会打commonjs都打到两个文件包里面去，而是自动增加一个<script src="common.js"></script>到引用的文件前面。</p>

<h2 id="js">js异步加载</h2>
<p>对于一个打包工具，我们很自然去关心异步的问题。commonJS是同步的，但是webpack提供了一个处理异步的方法，这样在页面上处理路由等就很有用，例如以下配置可以在条件分支上异步加载js模块。当打包的模块被引入时webpack会假设被异步打包的文件都在根路径上，并最后通过插入到script标签中来实现异步加载。</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14</pre></td><td class="code"><pre><span class="k">if</span> <span class="p">(</span><span class="nb">window</span><span class="p">.</span><span class="nx">location</span><span class="p">.</span><span class="nx">pathname</span> <span class="o">===</span> <span class="s1">'/feed'</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">showLoadingState</span><span class="p">();</span>
  <span class="nx">require</span><span class="p">.</span><span class="nx">ensure</span><span class="p">([],</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span> <span class="c1">// this syntax is weird but it works</span>
    <span class="nx">hideLoadingState</span><span class="p">();</span>
    <span class="nx">require</span><span class="p">(</span><span class="s1">'./feed'</span><span class="p">).</span><span class="nx">show</span><span class="p">();</span> <span class="c1">// when this function is called, the module is guaranteed to be synchronously available.</span>
  <span class="p">});</span>
<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nb">window</span><span class="p">.</span><span class="nx">location</span><span class="p">.</span><span class="nx">pathname</span> <span class="o">===</span> <span class="s1">'/profile'</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">showLoadingState</span><span class="p">();</span>
  <span class="nx">require</span><span class="p">.</span><span class="nx">ensure</span><span class="p">([],</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">hideLoadingState</span><span class="p">();</span>
    <span class="nx">require</span><span class="p">(</span><span class="s1">'./profile'</span><span class="p">).</span><span class="nx">show</span><span class="p">();</span>
  <span class="p">});</span>
<span class="p">}</span>

</pre></td></tr></tbody></table>
</div>
</div>

<h2 id="revision">对文件做revision</h2>

<p>使用webpack可对文件生成带hash的文件名
output: { chunkFilename: “[chunkhash].bundle.js” }
引入可插件就可以这样写</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9
10</pre></td><td class="code"><pre><span class="nx">plugins</span><span class="err">:</span> <span class="p">[</span>
  <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">plugin</span><span class="p">(</span><span class="s2">"done"</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">stats</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">require</span><span class="p">(</span><span class="s2">"fs"</span><span class="p">).</span><span class="nx">writeFileSync</span><span class="p">(</span>
        <span class="nx">path</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="nx">__dirname</span><span class="p">,</span> <span class="s2">"..."</span><span class="p">,</span> <span class="s2">"stats.json"</span><span class="p">),</span>
        <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">stats</span><span class="p">.</span><span class="nx">toJson</span><span class="p">()));</span>
    <span class="p">});</span>
  <span class="p">}</span>
<span class="p">]</span>

</pre></td></tr></tbody></table>
</div>
</div>

<h2 id="section-3">上线压缩：</h2>
<p>压缩js</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4</pre></td><td class="code"><pre><span class="nx">plugins</span><span class="err">:</span> <span class="p">[</span>
   <span class="k">new</span> <span class="nx">webpack</span><span class="p">.</span><span class="nx">optimize</span><span class="p">.</span><span class="nx">MinChunkSizePlugin</span><span class="p">(</span><span class="nx">minSize</span><span class="p">)</span>
<span class="p">]</span>

</pre></td></tr></tbody></table>
</div>
</div>

<p>优化react</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5</pre></td><td class="code"><pre><span class="k">new</span> <span class="nx">webpack</span><span class="p">.</span><span class="nx">DefinePlugin</span><span class="p">({</span>
  <span class="s2">"process.env"</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">NODE_ENV</span><span class="p">:</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="s2">"production"</span><span class="p">)</span>
  <span class="p">}</span>
<span class="p">})</span>
</pre></td></tr></tbody></table>
</div>
</div>

<p>cdn替换
替换 CDN 这个工作, webpack 也内置了, 设置 output.publicPath 即可。http://webpack.github.io/docs/configuration.html#output-publicpath</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11</pre></td><td class="code"><pre><span class="c1">// Example</span>
<span class="nl">output</span><span class="p">:</span> <span class="p">{</span>
    <span class="nl">path</span><span class="p">:</span> <span class="s2">"/home/proj/public/assets"</span><span class="p">,</span>
    <span class="nx">publicPath</span><span class="err">:</span> <span class="s2">"/assets/"</span>
<span class="p">}</span>
<span class="c1">// Example CDN</span>
<span class="nl">output</span><span class="p">:</span> <span class="p">{</span>
    <span class="nl">path</span><span class="p">:</span> <span class="s2">"/home/proj/cdn/assets/[hash]"</span><span class="p">,</span>
    <span class="nx">publicPath</span><span class="err">:</span> <span class="s2">"http://cdn.example.com/assets/[hash]/"</span>
<span class="p">}</span>

</pre></td></tr></tbody></table>
</div>
</div>

<p>对比下fis
相对于fis更加轻量级，webpack更加灵活</p>

<p>最后给几个官方文档的地址：
http://webpack.github.io/
https://github.com/webpack
http://webpack.github.io/docs/
https://github.com/petehunt/webpack-howto</p>


</article>


<div class="tags">
	<strong>Tags:</strong> <a target="_blank" href="/tags/?tag=webpack">webpack</a>,&nbsp;<a target="_blank" href="/tags/?tag=打包工具">打包工具</a>
</div>


	<script src="/assets/js/github.comment.js"></script>
	<div class="gc-comments" data-repos="ouvens/ouvens.github.io" data-issues="3" >
	    <div class="gc-comments-title">
	        评论
	    </div>
	    <div class="gc-comments-info">
	        想在此留下评论，请访问 <a href="issues_link">issues_link</a> 提交评论
	    </div>
	</div>
</div>
</div>


    </div>
    
<div class="qr-code qr-code-pay" title="加个微信交流交流">
    <img src="/assets/qrcode/qr-code-person.jpg" width="200" height="200" alt="公众号">
    <p>加我赏红包，哈哈哈</p>
</div>

<div class="qr-code qr-code-wx" title="定期获取更新动态">
    <img src="/assets/qrcode/qrcode.jpg" width="200" height="200" alt="公众号">
    <p>欢迎关注 <strong>极限前端</strong> 公众号</p>
</div>


    
<footer class="site-footer">
  <div class="wrapper">
    <h3 class="footer-heading">极限前端</h3>
    <div class="site-navigation">
    	<p><strong>站内</strong></p>
      <ul class="pages">
        
        
          <li class="nav-link"><a href="/about/">关于</a>
        
        
        
        
        
        
        
        
        
          <li class="nav-link"><a href="/category/">所有文章</a>
        
        
        
          <li class="nav-link"><a href="/tags/">标签分类</a>
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
      </ul>
    </div>
    <div class="site-contact">
    	<p><strong>相关链接</strong></p>
        <ul class="social-media-list">
      	<li>
      		<a href="mailto:1025224452@qq.com">
	      		<i class="icon-font i-star"></i>
	      		<span class="username">1025224452@qq.com</span>
      		</a>
      	</li>

      	
	      	
	      	<li>
	           <a href="https://github.com/ouvens" title="Fork me on GitHub">
	               <i class="icon-font i-heart"></i>
	               <span class="username">ouvens</span>
	           </a>
	        </li>
	      	
      	

      </ul>
    </div>
    <div class="site-signature">
    	<p class="rss-subscribe text"><strong>订阅<a href="/feed.xml">via RSS</a></strong></p>
      <p class="text">极限前端, 极限前端社区, ouven的博客, ouvenzhang的博客, www.jixianqianduan.com, github地址, 前端技术, 讲述前端高效技术与前沿。</p>
    </div>
  </div>
</footer>

<!-- Scripts -->
<script src="//1.url.cn/jslib/jquery/1.9.1/jquery.min.js" defer></script>

<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.5/highlight.min.js" defer></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/lightbox2/2.7.1/js/lightbox.min.js" defer></script>

<script src="/assets/js/main.js" defer></script>

    </body>
</html>
