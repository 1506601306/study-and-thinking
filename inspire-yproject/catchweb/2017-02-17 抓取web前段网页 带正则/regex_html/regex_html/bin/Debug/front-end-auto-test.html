<!DOCTYPE html>
<html>
    <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="google-site-verification" content="0FNbiBWk1FugWYo-RiGxQyIHebGeLoXp3HB7AxIFKy8" />
    <meta name="baidu-site-verification" content="tYoUqpkCCv" />
    <meta name="baidu-site-verification" content="IGN97NW90O" />
    
    <title>前端自动化测试解决方案探析 | ouvenzhang的博客</title>

    <meta http-equiv="x-dns-prefetch-control" content="on" />
    <link rel="dns-prefetch" href="cdnjs.cloudflare.com" />
    <link rel="dns-prefetch" href="1.url.cn" />

    <meta name="description" itemprop="description" content="前端自动化测试解决方案探析,test,测试,前端自动化测试 ">
    <meta itemprop="name" content="前端自动化测试解决方案探析">
    <meta itemprop="image" content="http://ouvens.github.io/blog/assets/logo.png">
    <meta itemprop="keywords" name="keywords" content="前端自动化测试解决方案探析,test,测试,前端自动化测试 ">

    
    <meta name="author" content="ouvenzhang">
    <meta name="copyright" content="&copy; ouvenzhang 2017">
    <meta name="protocol" content="1">
    

    <!-- External libraries -->
    <link rel="stylesheet" href="/assets/css/iconfont.css">
    <link rel="stylesheet" href="/css/monokai_sublime.css">

    <!-- Favicon and other icons (made with http://www.favicon-generator.org/) -->
    <link rel="shortcut icon" href="/assets/favicon.ico" type="image/x-icon">
  	<link rel="icon" href="/assets/favicon.ico" type="image/x-icon">
    
  	<meta name="msapplication-TileColor" content="#ffffff">
  	<meta name="theme-color" content="#ffffff">
    <meta name="msapplication-TileImage" content="/assets/icons/icon.png">

  	<!-- Site styles -->
    <link rel="stylesheet" href="/css/main.css">

    <link rel="alternate" type="application/rss+xml" title="极限前端" href="http://ouvens.github.io//feed.xml" />
    <script>
    // 访问统计
    var domain = 'jixianqianduan.com';
    var oldDomain = 'ouvens.github.io';
    if(location.host === domain){
        var _hmt = _hmt || [];
        (function() {
          var hm = document.createElement("script");
          hm.src = "//hm.baidu.com/hm.js?b536b128dc21c3d18fdc028f0609e3f0";
          var s = document.getElementsByTagName("script")[0]; 
          s.parentNode.insertBefore(hm, s);
        })();
    }else if(location.host === oldDomain){
        window.location.href = location.href.replace(oldDomain, domain);
        var _hmt = _hmt || [];
        (function() {
          var hm = document.createElement("script");
          hm.src = "//hm.baidu.com/hm.js?041efd2cb345ca1b9dbdbb2383cb716d";
          var s = document.getElementsByTagName("script")[0]; 
          s.parentNode.insertBefore(hm, s);
        })();
    }

    // 链接提交

    if(location.protocol === 'https'){
        !function(){var e=/([http|https]:\/\/[a-zA-Z0-9\_\.]+\.baidu\.com)/gi,r=window.location.href,t=document.referrer;if(!e.test(r)){var o="https://sp0.baidu.com/9_Q4simg2RQJ8t7jm9iCKT-xh_/s.gif";t?(o+="?r="+encodeURIComponent(document.referrer),r&&(o+="&l="+r)):r&&(o+="?l="+r);var i=new Image;i.src=o}}(window);
    }else{
        !function(){var e=/([http|https]:\/\/[a-zA-Z0-9\_\.]+\.baidu\.com)/gi,r=window.location.href,o=document.referrer;if(!e.test(r)){var n="//api.share.baidu.com/s.gif";o?(n+="?r="+encodeURIComponent(document.referrer),r&&(n+="&l="+r)):r&&(n+="?l="+r);var t=new Image;t.src=n}}(window);
    }


    </script>
</head>

    <body>
        <div class="navigation" role="banner">
    <div class="navigation-wrapper">
    <a href="/" class="logo">
    	
      <img src="/assets/logo.png" alt="极限前端">
      
    </a>
    <span class="search-input" id="search-input">
      <input type="text" value="" class="search-text" placeholder="输入搜索关键字">
      <i class="icon-font i-search search-btn"></i>
    </span>
    <a href="javascript:void(0)" class="navigation-menu-button" id="js-mobile-menu">
    	<i class="icon-font i-list fa fa-bars"></i>
    </a>
    <span class="nav" role="navigation">
      <ul id="js-navigation-menu" class="navigation-menu show">
      	
          
          <li class="nav-link">
            <a href="/about/">关于</a>
          </li>
          
        
          
        
          
        
          
        
          
          <li class="nav-link">
            <a href="/category/">所有文章</a>
          </li>
          
        
          
          <li class="nav-link">
            <a href="/tags/">标签分类</a>
          </li>
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          <li id="github-info" class="nav-link" title="https://github.com/ouvens">
            <a class="github-info" href="https://github.com/ouvens" target="_blank">
            <img src="/assets/github.png" height="34" width="130" alt="github地址"></a>
          </li>
      </ul>
    </span>
  </div>
</div>

            <div class="page-content">
        <div class="post">
<div class="post-header-container has-cover">
	<header class="post-header">
	  <h1 class="title">前端自动化测试解决方案探析</h1>
	  <p class="info">by <strong>ouven</strong></p>
	</header>
</div>
<div class="wrapper">



<div class="post-meta">
	<div class="post-date">2016年11月22日</div>
	<div class="post-categories">
	 in  
		<a target="_blank" href="/category/?cate=frontend-javascript">Frontend-javascript</a>
	  
	</div>
</div>	

<article class="post-content">
  <p>  前端测试一直是前端项目开发过程中机器重要的一个环节，高效的测试方法可以减少我们进行代码自测的时间，提高我们的开发效率，如果你的代码涉及的测试用例较多，而且项目需要长期维护，这时就可以考虑使用一下自动化测试了。</p>

<h4 id="section">一、前端自动化测试</h4>

<p>  前端自动化测试一般是指是在预设条件下运行前端页面或逻辑模块，评估运行结果。预设条件应包括正常条件和异常条件，以达到自动运行测试过程、减少或避免人工干预测试的目的。在前端自动化测试中，我们通常是通过不同的工具来解决不同场景下不同的问题的。就测试类型来看，主要分为BDD(Bebavior Driven Developement，行为驱动测试)和TDD(Testing Driven Developement，测试驱动开发)。BDD可以让项目成员（甚至是不懂编程的）使用自然描述语言来描述系统功能和业务逻辑，从而根据这些描述步骤进行系统自动化的测试；TDD则要求在编写某个功能的代码之前先编写测试代码，然后只编写使测试通过的功能代码，通过测试来推动整个开发的进行。这有助于编写简洁可用和高质量的代码，并加速实际开发过程</p>

<p>  BDD和TDD均有各自的适用场景，BDD一般更偏向于系统功能和业务逻辑的自动化测试设计，而TDD在快速开发并测试功能模块的过程中则更加高效，以快速完成开发为目的。下面我们看下BDD和TDD具体的特点：</p>

<p>BDD的特点：
- 从业务逻辑的角度定义具体的输入与预期输出，以及可衡量的目标；
- 尽可能覆盖所有的测试用例情况；
- 描述一系列可执行的行为，根据业务的分析来定义预期输出。例如，expect, should, assert；
- 设定关键的测试通过节点输出提示，便于测试人员理解；
- 最大程度的交付出符合用户期望的产品，避免输出不一致带来的问题。</p>

<p>TDD的特点：
- 需求分析，快速编写对应的输入输出测试脚本；
- 实现代码让测试为成功；
- 重构，然后重复测试，最终让程序符合所有要求。</p>

<h4 id="section-1">二、单元测试解决方案</h4>

<p>  就前端而言，单元测试的实现工具比较多。主要有mocha，jasmine和qunit。我们先来看看使用mocha是怎样实现单元测试的。</p>

<ul>
  <li>mocha</li>
</ul>

<p>  mocha的特点是简单可扩展、支持浏览器和Node、支持同步和异步、支持连续用例测试。测试集，以函数describe(string, function)封装；测试用例，以it(string, function)函数封装，它包含2个参数；断言，以assert语句表示，返回true或false。另外，mocha在完成异步测试用例时通过done()来标记。</p>

<div class="highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3</pre></td><td class="code"><pre>$ npm install mocha
$ mkdir test
$ $EDITOR test/test.js # or open with your favorite editor
</pre></td></tr></tbody></table>
</div>
</div>

<p>  测试用例：</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8</pre></td><td class="code"><pre><span class="kd">var</span> <span class="nx">assert</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'assert'</span><span class="p">);</span>
<span class="nx">describe</span><span class="p">(</span><span class="s1">'Array'</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="nx">describe</span><span class="p">(</span><span class="s1">'#indexOf()'</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">it</span><span class="p">(</span><span class="s1">'should return -1 when the value is not present'</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="nx">assert</span><span class="p">.</span><span class="nx">equal</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">].</span><span class="nx">indexOf</span><span class="p">(</span><span class="mi">4</span><span class="p">));</span>
    <span class="p">});</span>
  <span class="p">});</span>
<span class="p">});</span>
</pre></td></tr></tbody></table>
</div>
</div>

<p>  输出为：</p>

<div class="highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8</pre></td><td class="code"><pre>$ ./node_modules/mocha/bin/mocha

  Array
    #indexOf()
      ✓ should return -1 when the value is not present


  1 passing (9ms)
</pre></td></tr></tbody></table>
</div>
</div>

<p>  同时，mocha支持异步和Promise。</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9
10</pre></td><td class="code"><pre><span class="nx">describe</span><span class="p">(</span><span class="s1">'#find()'</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">it</span><span class="p">(</span><span class="s1">'respond with matching records'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">done</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">db</span><span class="p">.</span><span class="nx">find</span><span class="p">({</span><span class="na">type</span><span class="p">:</span> <span class="s1">'User'</span><span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="k">return</span> <span class="nx">done</span><span class="p">(</span><span class="nx">err</span><span class="p">);</span>
            <span class="nx">res</span><span class="p">.</span><span class="nx">should</span><span class="p">.</span><span class="nx">have</span><span class="p">.</span><span class="nx">length</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span>
            <span class="nx">done</span><span class="p">();</span>
            <span class="p">});</span>
        <span class="p">});</span>
    <span class="p">});</span>
<span class="p">});</span>
</pre></td></tr></tbody></table>
</div>
</div>

<p><a href="http://mochajs.org/">http://mochajs.org/</a></p>

<ul>
  <li>jasmine。</li>
</ul>

<p>  jasmine是一个BTT的框架，不依赖其它框架。测试集以函数describe(string, function)封装；测试用例，以it(string, function)函数封装，它也包含2个参数；断言，以expect语句表示，返回true或false；断言的比较操作时，将Expectation传入的实际值和Matcher传入的期望值比较，另外任何Matcher都能通过在expect调用Matcher前加上not来实现一个否定的断言（expect(a).not().toBe(false);）</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9</pre></td><td class="code"><pre><span class="nx">describe</span><span class="p">(</span><span class="s2">"A suite is just a function"</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">a</span><span class="p">;</span>
    <span class="nx">it</span><span class="p">(</span><span class="s2">"and so is a spec"</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">a</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>

        <span class="nx">expect</span><span class="p">(</span><span class="nx">a</span><span class="p">).</span><span class="nx">toBe</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>
        <span class="nx">expect</span><span class="p">(</span><span class="nx">a</span><span class="p">).</span><span class="nx">not</span><span class="p">().</span><span class="nx">toBe</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>
    <span class="p">});</span>
<span class="p">});</span>
</pre></td></tr></tbody></table>
</div>
</div>

<p>  jasmine也支持异步测试用例。</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15</pre></td><td class="code"><pre><span class="nx">describe</span><span class="p">(</span><span class="s2">"long asynchronous specs"</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">beforeEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">done</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">done</span><span class="p">();</span>
<span class="p">},</span> <span class="mi">1000</span><span class="p">);</span>

<span class="nx">it</span><span class="p">(</span><span class="s2">"takes a long time"</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">done</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">done</span><span class="p">();</span>
    <span class="p">},</span> <span class="mi">9000</span><span class="p">);</span>
<span class="p">},</span> <span class="mi">10000</span><span class="p">);</span>

<span class="nx">afterEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">done</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">done</span><span class="p">();</span>
    <span class="p">},</span> <span class="mi">1000</span><span class="p">);</span>
<span class="p">});</span>
</pre></td></tr></tbody></table>
</div>
</div>

<p><a href="https://jasmine.github.io/2.5/introduction">https://jasmine.github.io/2.5/introduction</a></p>

<ul>
  <li>qunit</li>
</ul>

<p>  qunit是一个可基于jquery的简单测试框架，主要运行在浏览器端。它通过QUnit.test定义一个测试集，一个测试集中通过回调函数里面多个断言判断来实现多个测试用例，使用起来非常简单。</p>

<div class="language-html highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22</pre></td><td class="code"><pre>
<span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="nt">&lt;html&gt;</span>
<span class="nt">&lt;head&gt;</span>
    <span class="nt">&lt;meta</span> <span class="na">charset=</span><span class="s">"utf-8"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;meta</span> <span class="na">name=</span><span class="s">"viewport"</span> <span class="na">content=</span><span class="s">"width=device-width"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;title&gt;</span>QUnit Example<span class="nt">&lt;/title&gt;</span>
    <span class="nt">&lt;link</span> <span class="na">rel=</span><span class="s">"stylesheet"</span> <span class="na">href=</span><span class="s">"https://code.jquery.com/qunit/qunit-2.0.1.css"</span><span class="nt">&gt;</span>
<span class="nt">&lt;/head&gt;</span>
<span class="nt">&lt;body&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"qunit"</span><span class="nt">&gt;&lt;/div&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"qunit-fixture"</span><span class="nt">&gt;&lt;/div&gt;</span>
    <span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"https://code.jquery.com/qunit/qunit-2.0.1.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
    <span class="nt">&lt;script&gt;</span>
    <span class="nx">QUnit</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span> <span class="s2">"hello test"</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">assert</span> <span class="p">)</span> <span class="p">{</span>
        <span class="nx">assert</span><span class="p">.</span><span class="nx">ok</span><span class="p">(</span> <span class="mi">1</span> <span class="o">==</span> <span class="s2">"1"</span><span class="p">,</span> <span class="s2">"Passed!"</span> <span class="p">);</span>
        <span class="nx">assert</span><span class="p">.</span><span class="nx">equal</span><span class="p">(</span> <span class="kc">null</span><span class="p">,</span> <span class="kc">false</span><span class="p">,</span> <span class="s2">"null, false; equal fails"</span> <span class="p">);</span>
    <span class="p">});</span>
    <span class="nt">&lt;/script&gt;</span>
<span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>

</pre></td></tr></tbody></table>
</div>
</div>

<p>  qunit也支持异步测试用例，异步完成时通过done()来结束。</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8</pre></td><td class="code"><pre><span class="nx">QUnit</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span> <span class="s2">"assert.async() test"</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">assert</span> <span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">done</span> <span class="o">=</span> <span class="nx">assert</span><span class="p">.</span><span class="nx">async</span><span class="p">();</span>
    <span class="kd">var</span> <span class="nx">input</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span> <span class="s2">"#test-input"</span> <span class="p">).</span><span class="nx">focus</span><span class="p">();</span>
    <span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">assert</span><span class="p">.</span><span class="nx">equal</span><span class="p">(</span> <span class="nb">document</span><span class="p">.</span><span class="nx">activeElement</span><span class="p">,</span> <span class="nx">input</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">"Input was focused"</span> <span class="p">);</span>
        <span class="nx">done</span><span class="p">();</span>
    <span class="p">});</span>
<span class="p">});</span>
</pre></td></tr></tbody></table>
</div>
</div>

<p><a href="http://api.qunitjs.com/async/">http://api.qunitjs.com/async/</a></p>

<p>  小结一下，单元测试工具的主要组成部分其实是类似的，主要包括测试集、测试用例、断言和断言比较等。它可以用来快速测试单元模块的主要功能，有助于辅助我们快速开发。</p>

<h4 id="section-2">三、集成化测试解决方案</h4>

<p>  除了模块单元的测试驱动开发，在系统功能测试阶段，我们希望自动化完成业务功能正确性的检测，此时我们就要考虑集成测试方案了。目前前端集成化测试自动化工具也有比较多。例如CasperJS、Nighmare、Nightwatch、Dalekjs，我们来逐个看下。</p>

<ul>
  <li>casperJS。</li>
</ul>

<p>  casperJS基于PhantomJS或SlimerJS(PhantomJS或SlimerJS都是用于web测试的自动化无界面浏览器)，可以模拟完成页面内系统级的自动化操作行为测试。</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13</pre></td><td class="code"><pre>
<span class="kd">var</span> <span class="nx">casper</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'casper'</span><span class="p">).</span><span class="nx">create</span><span class="p">();</span>
<span class="nx">casper</span><span class="p">.</span><span class="nx">start</span><span class="p">(</span><span class="s1">'http://casperjs.org/'</span><span class="p">);</span>

<span class="nx">casper</span><span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">echo</span><span class="p">(</span><span class="s1">'First Page: '</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">getTitle</span><span class="p">());</span>
<span class="p">});</span>

<span class="nx">casper</span><span class="p">.</span><span class="nx">thenOpen</span><span class="p">(</span><span class="s1">'http://phantomjs.org'</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">echo</span><span class="p">(</span><span class="s1">'Second Page: '</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">getTitle</span><span class="p">());</span>
<span class="p">});</span>

<span class="nx">casper</span><span class="p">.</span><span class="nx">run</span><span class="p">();</span>
</pre></td></tr></tbody></table>
</div>
</div>

<p>  输出内容为：</p>

<div class="highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3</pre></td><td class="code"><pre>$ casperjs sample.js
First Page: CasperJS - a navigation scripting &amp; testing utility for PhantomJS and SlimerJS written in Javascript
Second Page: PhantomJS | PhantomJS
</pre></td></tr></tbody></table>
</div>
</div>

<p>  页面内的操作结合casper的操作就可以这样来实现。</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26</pre></td><td class="code"><pre>
<span class="kd">var</span> <span class="nx">casper</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'casper'</span><span class="p">).</span><span class="nx">create</span><span class="p">();</span>
<span class="kd">var</span> <span class="nx">links</span><span class="p">;</span>

<span class="kd">function</span> <span class="nx">getLinks</span><span class="p">()</span> <span class="p">{</span>
<span class="c1">// Scrape the links from top-right nav of the website</span>
    <span class="kd">var</span> <span class="nx">links</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">querySelectorAll</span><span class="p">(</span><span class="s1">'ul.navigation li a'</span><span class="p">);</span>
    <span class="k">return</span> <span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">map</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">links</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">e</span><span class="p">.</span><span class="nx">getAttribute</span><span class="p">(</span><span class="s1">'href'</span><span class="p">)</span>
    <span class="p">});</span>
<span class="p">}</span>

<span class="c1">// Opens casperjs homepage</span>
<span class="nx">casper</span><span class="p">.</span><span class="nx">start</span><span class="p">(</span><span class="s1">'http://casperjs.org/'</span><span class="p">);</span>

<span class="nx">casper</span><span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="nx">links</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">evaluate</span><span class="p">(</span><span class="nx">getLinks</span><span class="p">);</span>
<span class="p">});</span>

<span class="nx">casper</span><span class="p">.</span><span class="nx">run</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="k">in</span> <span class="nx">links</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">links</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span>
    <span class="p">}</span>
    <span class="nx">casper</span><span class="p">.</span><span class="nx">done</span><span class="p">();</span>
<span class="p">});</span>

</pre></td></tr></tbody></table>
</div>
</div>

<p><a href="http://casperjs.org/">http://casperjs.org/</a></p>

<ul>
  <li>Nightmare。</li>
</ul>

<p>  类似的，nightmare也是一个模拟还原浏览器上业务操作的强大工具，而且更易于使用。同时可以使用chrome的插件daydreem自动录制生成用户行为操作的事件序列，更加方便我们进行实际的测试。</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5</pre></td><td class="code"><pre><span class="k">yield</span> <span class="nx">Nightmare</span><span class="p">()</span>
    <span class="p">.</span><span class="kr">goto</span><span class="p">(</span><span class="s1">'http://yahoo.com'</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">type</span><span class="p">(</span><span class="s1">'input[title="Search"]'</span><span class="p">,</span> <span class="s1">'github nightmare'</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">click</span><span class="p">(</span><span class="s1">'.searchsubmit'</span><span class="p">);</span>

</pre></td></tr></tbody></table>
</div>
</div>

<p>  Nightmare也支持异步操作，并支持多种断言库，这里结合chai.js就可以这样来使用。</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21</pre></td><td class="code"><pre><span class="kd">var</span> <span class="nx">Nightmare</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'nightmare'</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">expect</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'chai'</span><span class="p">).</span><span class="nx">expect</span><span class="p">;</span> <span class="c1">// jshint ignore:line</span>

<span class="nx">describe</span><span class="p">(</span><span class="s1">'test yahoo search results'</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">it</span><span class="p">(</span><span class="s1">'should find the nightmare github link first'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">done</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">nightmare</span> <span class="o">=</span> <span class="nx">Nightmare</span><span class="p">()</span>
    <span class="nx">nightmare</span>
      <span class="p">.</span><span class="kr">goto</span><span class="p">(</span><span class="s1">'http://yahoo.com'</span><span class="p">)</span>
      <span class="p">.</span><span class="nx">type</span><span class="p">(</span><span class="s1">'form[action*="/search"] [name=p]'</span><span class="p">,</span> <span class="s1">'github nightmare'</span><span class="p">)</span>
      <span class="p">.</span><span class="nx">click</span><span class="p">(</span><span class="s1">'form[action*="/search"] [type=submit]'</span><span class="p">)</span>
      <span class="p">.</span><span class="nx">wait</span><span class="p">(</span><span class="s1">'#main'</span><span class="p">)</span>
      <span class="p">.</span><span class="nx">evaluate</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s1">'#main .searchCenterMiddle li a'</span><span class="p">).</span><span class="nx">href</span>
      <span class="p">})</span>
      <span class="p">.</span><span class="nx">end</span><span class="p">()</span>
      <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">link</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">expect</span><span class="p">(</span><span class="nx">link</span><span class="p">).</span><span class="nx">to</span><span class="p">.</span><span class="nx">equal</span><span class="p">(</span><span class="s1">'https://github.com/segmentio/nightmare'</span><span class="p">);</span>
        <span class="nx">done</span><span class="p">();</span>
      <span class="p">})</span>
  <span class="p">});</span>
<span class="p">});</span>
</pre></td></tr></tbody></table>
</div>
</div>

<p><a href="http://www.nightmarejs.org/">http://www.nightmarejs.org/</a></p>

<ul>
  <li>Nightwatch。</li>
</ul>

<p>  Nightwatch则可以使用node书写端对端的测试用例，并在Selenium server服务端运行测试，同样支持同步和异步。</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11</pre></td><td class="code"><pre><span class="k">this</span><span class="p">.</span><span class="nx">demoTestGoogle</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">browser</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">browser</span>
    <span class="p">.</span><span class="nx">url</span><span class="p">(</span><span class="s1">'http://www.google.com'</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">waitForElementVisible</span><span class="p">(</span><span class="s1">'body'</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">setValue</span><span class="p">(</span><span class="s1">'input[type=text]'</span><span class="p">,</span> <span class="s1">'nightwatch'</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">waitForElementVisible</span><span class="p">(</span><span class="s1">'button[name=btnG]'</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">click</span><span class="p">(</span><span class="s1">'button[name=btnG]'</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">pause</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">assert</span><span class="p">.</span><span class="nx">containsText</span><span class="p">(</span><span class="s1">'#main'</span><span class="p">,</span> <span class="s1">'The Night Watch'</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">end</span><span class="p">();</span>
<span class="p">};</span>
</pre></td></tr></tbody></table>
</div>
</div>
<p><a href="http://nightwatchjs.org/">http://nightwatchjs.org/</a></p>

<ul>
  <li>Dalekjs</li>
</ul>

<p>  DalekJS是一个跨浏览器平台的前端集成测试框架，可以自动配置启动本地的浏览器，也可以模拟填写提交表单、点击、截屏、运行单元测试等丰富的操作。</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13</pre></td><td class="code"><pre>
<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">'Amazon does its thing'</span><span class="p">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">test</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">test</span>
        <span class="p">.</span><span class="nx">open</span><span class="p">(</span><span class="s1">'http://www.amazon.com/'</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">type</span><span class="p">(</span><span class="s1">'#twotabsearchtextbox'</span><span class="p">,</span> <span class="s1">'Blues Brothers VHS'</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">click</span><span class="p">(</span><span class="s1">'.nav-submit-input'</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">waitForElement</span><span class="p">(</span><span class="s1">'#result_0'</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">assert</span><span class="p">.</span><span class="nx">text</span><span class="p">(</span><span class="s1">'#result_0 .newaps a span'</span><span class="p">).</span><span class="nx">is</span><span class="p">(</span><span class="s1">'The Blues Brothers'</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">done</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">};</span>

</pre></td></tr></tbody></table>
</div>
</div>

<div class="language-javascript highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5</pre></td><td class="code"><pre><span class="nx">test</span><span class="p">.</span><span class="nx">open</span><span class="p">(</span><span class="s1">'http://adomain.com'</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">click</span><span class="p">(</span><span class="s1">'#aquestion'</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">answer</span><span class="p">(</span><span class="s1">'Rose'</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">assert</span><span class="p">.</span><span class="nx">text</span><span class="p">(</span><span class="s1">'#aquestion'</span><span class="p">).</span><span class="nx">is</span><span class="p">(</span><span class="s1">'Rose'</span><span class="p">,</span> <span class="s1">'Awesome she was!'</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">done</span><span class="p">();</span>
</pre></td></tr></tbody></table>
</div>
</div>

<p><a href="http://dalekjs.com/">http://dalekjs.com/</a></p>

<p>  小结一下，和单元测试相同的是，集成测试和单元测试类似，一般也会对测试预期输出进行断言和判断，不同的是，集成测试的输入设计和功能流程中涉及到浏览器本身的行为模拟，用以代替测试人员手动操作的过程，从而能够提高测试效率。</p>

<h4 id="section-3">四、总结与注意事项</h4>

<p>  通过对单元测试工具和集成测试工具的概述介绍，我们基本了解了单元测试和集成测试的核心部分和特点，尽管目前主流的测试工具各不相同，但是基本的流程原理确实相同的，上面小结里面也为大家做了分析。</p>

<p>  当然，还有一些仍需要我们注意的问题。自动化测试不可避免地要求我们去编写测试用例，会花去一定的事件，我们在实际的项目开发过程中，决定要不要使用自动化的测试方案应该根据具体的场景来决定，如果业务规模并不复杂，而且系统功能流程清晰，则不建议使用测试用例，因为这样得不偿失；但如果业务达到一定规模，需要在原有较大项目继续维护开发的情况下，编写测试用例有利于我们较快暴露和定位问题，并极有助于后期的维护。</p>

<p>参考资料：</p>

<p><a href="http://joshldavis.com/2013/05/27/difference-between-tdd-and-bdd/">http://joshldavis.com/2013/05/27/difference-between-tdd-and-bdd/</a></p>

<p><a href="https://pythonhosted.org/behave/philosophy.html">https://pythonhosted.org/behave/philosophy.html</a></p>

<p><a href="http://wiki.c2.com/?TestDrivenDevelopment">http://wiki.c2.com/?TestDrivenDevelopment</a></p>

</article>


<div class="tags">
	<strong>Tags:</strong> <a target="_blank" href="/tags/?tag=test">test</a>,&nbsp;<a target="_blank" href="/tags/?tag=测试">测试</a>,&nbsp;<a target="_blank" href="/tags/?tag=前端自动化测试">前端自动化测试</a>
</div>


	<script src="/assets/js/github.comment.js"></script>
	<div class="gc-comments" data-repos="ouvens/ouvens.github.io" data-issues="3" >
	    <div class="gc-comments-title">
	        评论
	    </div>
	    <div class="gc-comments-info">
	        想在此留下评论，请访问 <a href="issues_link">issues_link</a> 提交评论
	    </div>
	</div>
</div>
</div>


    </div>
    
<div class="qr-code qr-code-pay" title="加个微信交流交流">
    <img src="/assets/qrcode/qr-code-person.jpg" width="200" height="200" alt="公众号">
    <p>加我赏红包，哈哈哈</p>
</div>

<div class="qr-code qr-code-wx" title="定期获取更新动态">
    <img src="/assets/qrcode/qrcode.jpg" width="200" height="200" alt="公众号">
    <p>欢迎关注 <strong>极限前端</strong> 公众号</p>
</div>


    
<footer class="site-footer">
  <div class="wrapper">
    <h3 class="footer-heading">极限前端</h3>
    <div class="site-navigation">
    	<p><strong>站内</strong></p>
      <ul class="pages">
        
        
          <li class="nav-link"><a href="/about/">关于</a>
        
        
        
        
        
        
        
        
        
          <li class="nav-link"><a href="/category/">所有文章</a>
        
        
        
          <li class="nav-link"><a href="/tags/">标签分类</a>
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
      </ul>
    </div>
    <div class="site-contact">
    	<p><strong>相关链接</strong></p>
        <ul class="social-media-list">
      	<li>
      		<a href="mailto:1025224452@qq.com">
	      		<i class="icon-font i-star"></i>
	      		<span class="username">1025224452@qq.com</span>
      		</a>
      	</li>

      	
	      	
	      	<li>
	           <a href="https://github.com/ouvens" title="Fork me on GitHub">
	               <i class="icon-font i-heart"></i>
	               <span class="username">ouvens</span>
	           </a>
	        </li>
	      	
      	

      </ul>
    </div>
    <div class="site-signature">
    	<p class="rss-subscribe text"><strong>订阅<a href="/feed.xml">via RSS</a></strong></p>
      <p class="text">极限前端, 极限前端社区, ouven的博客, ouvenzhang的博客, www.jixianqianduan.com, github地址, 前端技术, 讲述前端高效技术与前沿。</p>
    </div>
  </div>
</footer>

<!-- Scripts -->
<script src="//1.url.cn/jslib/jquery/1.9.1/jquery.min.js" defer></script>

<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.5/highlight.min.js" defer></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/lightbox2/2.7.1/js/lightbox.min.js" defer></script>

<script src="/assets/js/main.js" defer></script>

    </body>
</html>
